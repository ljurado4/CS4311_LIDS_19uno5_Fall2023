<!--##################################################################
# File: LIDS_Dashboard.html
#
# Version: [5.0]
#
# Description: The file serves as the front-end template for a Local Intrusion Detection System (LIDS) Dashboard.
# It is designed to provide a user interface for monitoring network activity and handling intrusion alerts.
#
# @Author:Arturo Olmos
# Formatted the basic structure for the page, and added styling to it as well
#
# Modification History:
# [11/02/23] - [3.0] - [Lizbeth Jurado] - [File Description and Organization Set Up]
#
# Tasks:
# - Task 1]: Implement the backend logic to handle the connection form submission, processing the IP address and port number to establish or terminate a connection.
# - [Task 2]: Populate the alerts table with real-time data from the LIDS, ensuring that each entry accurately reflects an individual alert's details.
# - [Task 3]: Develop the sorting functionality in the JavaScript file LIDS_Table.js to allow users to sort the alerts based on different criteria such as level, time, and IP address.
# - Task 4]: Implement the filtering mechanism to view alerts of specific levels, utilizing the dropdown filter interface.
# - [Task 5]: Integrate server-side scripts to fetch and flash system notifications and errors in the designated tables.
# - [Task 6]: Ensure responsive design for different screen sizes and test the UI for usability and accessibility.
# - [Task 7]: Validate and sanitize user input to protect against potential security vulnerabilities such as SQL injection or cross-site scripting (XSS).
################################################################## -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../static/css/lids_dashboard.css">
    <title>LIDS Dashboard</title>
</head>

<body>
    <div class="header">
        <form action="/LIDS_Dashboard" method="post">
            <input type="text" name="IPInput" placeholder="IP Address" id="IPAdressForm">
            <input type="text" name="PortInput" placeholder="Port Number" id="PortNumberForm">
            <input type="submit" value="Connect" id="ConnectButton">
        </form>
        <div class="headerTitle" id="headerTitle">LIDS</div>
        <div class="connectedDisplay" id="connectedDisplay">Connected
            <img style="mix-blend-mode: multiply;height: 25px;width: 50px;vertical-align:text-bottom;"
                src="../static/img/Display_Box_Buttons.png">
            <form action="/disconnect" method="post" style="display:inline-block" id="disconnectButtonForm">
                <input class="disconnectButton dashboardButtonAction" type="submit" value="Disconnect">
            </form>
        </div>
    </div>
    <!-- content block is used to contain the left and right sidebars as well as the table in the middle -->
    <div id="contentBlock" style="border: solid;width: 100%;height: 100vh;vertical-align: top;display: flex;">
        <!-- left side bar -->
        <div class="leftSidebar" id="leftSidebar" style="vertical-align: top;">
            <form id="configFileForm">
                <input type="image" class="leftSidebarButton dashboardButtonAction leftSidebarImages"
                    src="../static/img/Display_Box_Buttons.png">
            </form>
            <br style="line-height: 20px;">
            <form id="alertsTableForm">
                <input type="image" class="leftSidebarButton dashboardButtonAction leftSidebarImages"
                    src="../static/img/Config_File_Button_IMG.png">
            </form>
        </div>
        <!-- table container x overflow of text is handled inside the td tag -->
        <div class="tableContainer" id="middleContainer" style="">
            <table id="alertBoxTable" >
                <thead>
                    <tr>
                        <th>Time</th>
                        <th>Identifier</th>
                        <th>Level</th>
                        <th>Source IP</th>
                        <th>Source Port</th>
                        <th>Destination IP</th>
                        <th>Destination Port</th>
                        <th>Alert Type</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th style="z-index: 10;">
                            <div style="text-align: center; z-index: 10;">
                                <div class="dropdown" style="z-index: 10;">
                                    <button id="filterByButton" onclick="toggleFilterDropdown()">Filter by Level</button>
                                    <div class="dropdown-options" id="filterByDropdownContent">
                                        <button onclick="filterByLevel(1); toggleFilterDropdown()">1</button>
                                        <button onclick="filterByLevel(2); toggleFilterDropdown()">1-2</button>
                                        <button onclick="filterByLevel(3); toggleFilterDropdown()">1-3</button>
                                        <button onclick="filterByLevel(4); toggleFilterDropdown()">1-4</button>
                                        <button onclick="filterByLevel(5); toggleFilterDropdown()">All</button>
                                    </div>
                                </div>
                            </div>
                        </th>
                        <th style="overflow: visible;">
                            <div>
                                <div class="dropdown">
                                    <button id="sortByButton" onclick="toggleDropdown()">Sort by</button>
                                    <div class="dropdown-options" id="sortByDropdownContent">
                                        <button onclick="sortTable(0); toggleDropdown()">Lvl</button>
                                        <button onclick="sortTable(1); toggleDropdown()">Time</button>
                                        <button onclick="sortTable(2); toggleDropdown()">IP</button>
                                        <button onclick="removeSort(); toggleDropdown()">None</button>
                                    </div>
                                </div>
                            </div>
                        </th>
                    </tr>
                </thead>
                <tbody >
                </tbody>
            </table>
        </div>
        <!-- right side bar -->
        <div  class="rightSidebar" id="rightSidebar">
            <!-- container for notifications table -->
            <div class="rightSidebarSC">
                <table id="notificationsTable">
                    <thead>
                        <tr>
                            <th>Notifications</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Notification 1</td>
                        </tr>
                        </tr>
                        {% for message in get_flashed_messages(category_filter=['success']) %}
                        <tr>
                            <td>{{ message }}</td>
                        </tr>
                        {% endfor %}
                        </tr>
                       
                    </tbody>
                </table>
            </div>
            <!-- container for errors table -->
            <div class="rightSidebarSC">
                <table id="errorsTable" >
                    <thead>
                        <tr>
                            <th>Errors</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Error 1</td>
                        </tr>
                        {% for message in get_flashed_messages(category_filter=['error']) %}
                        <tr>
                            <td>{{ message }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>


    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="../static/js/LIDS_Dashboard.js"></script>
    <script src="../static/js/LIDS_Table.js"></script>
</body>

</html>
